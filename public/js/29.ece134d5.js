"use strict";(self["webpackChunksssbaer_front"]=self["webpackChunksssbaer_front"]||[]).push([[29],{1832:(a,o,e)=>{e.r(o),e.d(o,{default:()=>L});var i=e(9835),t=e(1957);const l=(0,i.Uk)(" Tiene solicitudes sin confirmar, si fue atendido(a) correctamente porfavor confirmelas, Esto ayuda a la coordinacion de TIC ha contabilizar mejor su trabajo. ");function n(a,o,e,n,c,r){const d=(0,i.up)("q-icon"),s=(0,i.up)("q-banner"),u=(0,i.up)("q-toggle"),m=(0,i.up)("q-space"),p=(0,i.up)("solicitud-item"),f=(0,i.up)("q-table");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.wy)((0,i.Wm)(s,{rounded:"",class:"bg-grey-3"},{avatar:(0,i.w5)((()=>[(0,i.Wm)(d,{name:"contact_support",color:"primary"})])),default:(0,i.w5)((()=>[l])),_:1},512),[[t.F8,n.sinConfirmar>0]]),(0,i.Wm)(f,{title:"Mis solicitudes",rows:n.solicitudes,columns:n.columns,"row-key":"id",grid:"","hide-header":""},{top:(0,i.w5)((()=>[(0,i.Wm)(u,{modelValue:n.sinAtender,"onUpdate:modelValue":o[0]||(o[0]=a=>n.sinAtender=a),color:"red",label:"Sin atender",onClick:o[1]||(o[1]=a=>{n.cargarSolicitudes(),n.todas=!1})},null,8,["modelValue"]),(0,i.Wm)(u,{modelValue:n.enEspera,"onUpdate:modelValue":o[2]||(o[2]=a=>n.enEspera=a),color:"red",label:"En espera",onClick:o[3]||(o[3]=a=>{n.cargarSolicitudes(),n.todas=!1})},null,8,["modelValue"]),(0,i.Wm)(u,{modelValue:n.completadas,"onUpdate:modelValue":o[4]||(o[4]=a=>n.completadas=a),color:"red",label:"Completadas",onClick:o[5]||(o[5]=a=>{n.cargarSolicitudes(),n.todas=!1})},null,8,["modelValue"]),(0,i.Wm)(u,{modelValue:n.todas,"onUpdate:modelValue":o[6]||(o[6]=a=>n.todas=a),color:"red",label:"Todas",onClick:o[7]||(o[7]=a=>n.cargarSolicitudes())},null,8,["modelValue"]),(0,i.Wm)(m)])),item:(0,i.w5)((a=>[(0,i.Wm)(p,{data:a,onUpdateSolicitud:n.updateSolicitud},null,8,["data","onUpdateSolicitud"])])),_:1},8,["rows","columns"])],64)}var c=e(499),r=e(6183),d=e(1569),s=e(6970);const u={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition"},m={class:"q-ml-xs"};function p(a,o,e,l,n,c){const r=(0,i.up)("q-icon"),d=(0,i.up)("q-breadcrumbs-el"),p=(0,i.up)("q-breadcrumbs"),f=(0,i.up)("q-btn"),w=(0,i.up)("q-badge"),g=(0,i.up)("q-card-section"),b=(0,i.up)("q-separator"),h=(0,i.up)("q-item-label"),v=(0,i.up)("q-item-section"),y=(0,i.up)("q-item"),W=(0,i.up)("q-list"),Z=(0,i.up)("administrador-comp"),S=(0,i.up)("q-card-actions"),_=(0,i.up)("q-card");return(0,i.wg)(),(0,i.iD)("div",u,[(0,i.Wm)(_,null,{default:(0,i.w5)((()=>[(0,i.Wm)(g,{class:"row justify-between"},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{class:"text-grey"},{separator:(0,i.w5)((()=>[(0,i.Wm)(r,{size:"1.5em",name:"chevron_right",color:"negative"})])),default:(0,i.w5)((()=>[(0,i.Wm)(d,{icon:"hourglass_empty",class:(0,s.C_)(e.data.row.enProceso?"text-negative":"")},null,8,["class"]),(0,i.Wm)(d,{icon:"check_circle",class:(0,s.C_)(e.data.row.terminado&&!e.data.row.confirmada?"text-green":"")},null,8,["class"]),(0,i.Wm)(d,{icon:"verified",class:(0,s.C_)(e.data.row.confirmada?"text-green":"")},null,8,["class"])])),_:1}),(0,i.wy)((0,i.Wm)(f,{color:"green",label:"Confrimar","checked-icon":"check",onClick:o[0]||(o[0]=a=>l.confirmarSolicitud(e.data.row))},null,512),[[t.F8,e.data.row.terminado&&!e.data.row.confirmada]]),(0,i.Wm)(w,{color:"negative"},{default:(0,i.w5)((()=>[(0,i.Uk)(" ID: "+(0,s.zw)(e.data.row.id),1)])),_:1})])),_:1}),(0,i.Wm)(b),(0,i.Wm)(W,{dense:""},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.data.cols,(a=>((0,i.wg)(),(0,i.j4)(y,{key:a.name},{default:(0,i.w5)((()=>[(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(a.label),1)])),_:2},1024)])),_:2},1024),(0,i.Wm)(v,{side:""},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{caption:""},{default:(0,i.w5)((()=>[(0,i.Uk)((0,s.zw)(a.value),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,i.Wm)(b),(0,i.wy)((0,i.Wm)(Z,{id:e.data.row.idAdministrador},null,8,["id"]),[[t.F8,e.data.row.enProceso||e.data.row.terminado]]),(0,i.wy)((0,i.Wm)(S,null,{default:(0,i.w5)((()=>[(0,i._)("div",m," La solicitud ha sido cancelada, Razon: "+(0,s.zw)(e.data.row.razonCancelado),1)])),_:1},512),[[t.F8,e.data.row.razonCancelado&&!e.data.row.idAdministrador]])])),_:1})])}var f=e(4639),w=e(5255),g=e(1446);const b={components:{AdministradorComp:w.Z},name:"SolicitudItem",props:{data:Object},emits:["updateSolicitud"],setup(a,o){const e=(0,g.Z)(),t=(0,r.Z)();(0,i.bv)((()=>{try{f.apiEvents.Echo["private"](`solicitudes.${a.data.row.id}`).listen("SolicitudUsuarioActualizada",(a=>{o.emit("updateSolicitud",a.solicitud),a.solicitud.confirmada||e.notify({color:"info",icon:"info",message:`Solicitud con ID: ${a.solicitud.id} con problema de ${a.solicitud.problema} ha actualizado su status`,position:"top-right"})}))}catch(i){console.log(i),e.notify({color:"negative",icon:"info",message:"No se ha podido conectar al servidor de websockets"})}}));const l=async a=>{try{a.confirmada=!0;const o=await d.api.put(`/solicitudes/${a.id}`,a,t.authorizacion);"Update successfully"===o.data.message&&e.notify({type:"positive",message:`Solicitud con ID: ${o.data.solicitud.id} marcada como confirmada`})}catch(o){console.log(o),e.notify({type:"negative",message:"Error al confirmar la solicitud, revise la consola para mas informacion"})}};return{confirmarSolicitud:l}}};var h=e(1639),v=e(4458),y=e(3190),W=e(2605),Z=e(2857),S=e(8052),_=e(4455),C=e(990),q=e(926),k=e(3246),Q=e(490),I=e(1233),z=e(3115),U=e(1821),V=e(9984),A=e.n(V);const E=(0,h.Z)(b,[["render",p]]),x=E;A()(b,"components",{QCard:v.Z,QCardSection:y.Z,QBreadcrumbs:W.Z,QIcon:Z.Z,QBreadcrumbsEl:S.Z,QBtn:_.Z,QBadge:C.Z,QSeparator:q.Z,QList:k.Z,QItem:Q.Z,QItemSection:I.Z,QItemLabel:z.Z,QCardActions:U.Z});const B=[{name:"coordinacion",label:"Coordinacion",field:"coordinacion"},{name:"problema",label:"Tipo de problema",field:"problema"},{name:"comentarioAdicional",label:"Informacion adicional",field:"comentarioAdicional"}],j={components:{SolicitudItem:x},name:"SolicitudesUsuario",setup(){const a=(0,r.Z)(),o=(0,c.iH)(!1),e=(0,c.iH)(!1),t=(0,c.iH)(!1),l=(0,c.iH)(!0),n=(0,g.Z)(),s=a.data.user,u=(0,c.qj)([]),m=(0,i.Fl)((()=>u.filter((a=>Boolean(a.terminado)&&!Boolean(a.confirmada))).length)),p=async()=>{try{u.length=0;const i=await d.api.post("/solicitudes-usuario",{id:s.id},a.authorizacion),n=i.data.solicitudes;n.forEach((a=>{l.value?u.push(a):(!o.value||a.enProceso||a.terminado||u.push(a),e.value&&a.enProceso&&!a.terminado&&u.push(a),t.value&&a.terminado&&u.push(a))}))}catch(i){console.log(i),n.notify({color:"negative",icon:"info",message:"error al cargar las solicitudes, para mas informacion consulte la consola"})}},f=a=>{const o=u.findIndex((o=>o.id==a.id));u[o]=a};return(0,i.bv)((async()=>{p()})),{columns:B,solicitudes:u,updateSolicitud:f,cargarSolicitudes:p,sinAtender:o,enEspera:e,completadas:t,todas:l,sinConfirmar:m}}};var D=e(7128),H=e(1746),T=e(3175),F=e(136),$=e(6611);const P=(0,h.Z)(j,[["render",n]]),L=P;A()(j,"components",{QBanner:D.Z,QIcon:Z.Z,QTable:H.Z,QToggle:T.Z,QSpace:F.Z,QInput:$.Z})}}]);